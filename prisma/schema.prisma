datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model users {
  id          String        @id @default(auto()) @map("_id") @db.ObjectId
  nome        String
  email       String
  telefone    String
  senha       String
  fotoPerfil  String
  comentarios comentarios[]
}

model codeSession {
  id     String   @id @default(auto()) @map("_id") @db.ObjectId
  email  String
  codigo String
  date   DateTime
}

model pontos {
  id          String        @id @default(auto()) @map("_id") @db.ObjectId
  criadorId   String
  nome        String
  local       String
  endereco    String
  tipoApoio   Int
  data        String
  hora        String
  cidade      Int
  descricao   String
  coordenada  String
  status      Boolean
  contato     String
  instagram   String
  favoritos   favoritos[]
  comentarios comentarios[]
}

model cidades {
  id            String  @id @default(auto()) @map("_id") @db.ObjectId
  codigo_ibge   Int     @unique
  nome          String
  nome_completo String
  uf            String
  estado        String
  regiao        String
  coord         Float[] // Array [longitude, latitude]
  capital       Boolean
  ddd           Int?
}

model favoritos {
  id      String @id @default(auto()) @map("_id") @db.ObjectId
  user    String
  idPonto String
  ponto   pontos @relation(fields: [idPonto], references: [id], onDelete: Cascade)
}

model comentarios {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  pontoId    String
  userId     String
  comentario String
  data       String
  createdAt  DateTime

  ponto pontos @relation(fields: [pontoId], references: [id], onDelete: Cascade)
  user  users  @relation(fields: [userId], references: [id])
}

model PasswordResetCode {
  id        String    @id @default(auto()) @map("_id") @db.ObjectId
  email     String
  code      String
  expiresAt DateTime
  attempts  Int      @default(0)
  createdAt DateTime @default(now())
}